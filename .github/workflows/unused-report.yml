name: Unused Code Report
on:
pull_request:
types: [opened, synchronize, reopened]
workflow_dispatch: {}
jobs:
    analyze:
    runs-on: ubuntu-latest
    permissions:
    checks: write
    contents: read
    pull-requests: write
        steps:
        - uses: actions/checkout@v4
        - uses: actions/setup-node@v4
        with: { node-version: 20 }
        - run: npm ci
        - run: npm run build
        - name: Run analyzer (JSON)
    run: node ./dist/cli.js --report --report-format json --out analyzer-report.json
    - name: Annotate GitHub Check
    env:
    GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
    run: node ./scripts/annotate-checks.mjs analyzer-report.json